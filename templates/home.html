<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Taxable Tracker</title>
  <style>
    body { font-family:-apple-system,system-ui,Arial; margin:24px; }
    .top { display:flex; justify-content:space-between; align-items:center; gap:10px; }
    .card { border:1px solid #e6e6e6; border-radius:14px; padding:16px; margin-top:14px; }
    .row { display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .btn { padding:10px 12px; border:1px solid #333; border-radius:10px; text-decoration:none; color:#111; display:inline-block; }
    table { width:100%; border-collapse:collapse; margin-top:10px; }
    th, td { padding:10px 8px; border-bottom:1px solid #eee; text-align:left; font-size:14px; }
    .muted { color:#666; font-size:13px; }
    .pill { font-size:12px; padding:4px 8px; border:1px solid #ddd; border-radius:999px; }
  </style>
</head>
<body>

  <div class="top">
    <h2 style="margin:0;">Taxable Tracker</h2>
    <a class="btn" href="/ui/logout">Log out</a>
  </div>

  <div class="card">
    <div class="row">
      <a class="btn" href="/ui/transaction/new">âž• Add Transaction</a>
      <a class="btn" href="/ui/fuel/new">â›½ Add Fuel</a>
      <a class="btn" href="/ui/report">ðŸ“Š Reports</a>
    </div>
    <div class="muted" style="margin-top:10px;">
      Receipts save to: <span class="pill">{{ request.app.extra.get("receipts_dir","(set RECEIPTS_DIR env var)") }}</span>
    </div>
  </div>

  <div class="card">
    <h3 style="margin:0 0 8px;">Recent Transactions</h3>
    <table>
      <tr>
        <th>Date</th><th>Source</th><th>Type</th><th>Category</th><th>Amount</th><th>Receipt</th>
      </tr>
      {% for t in transactions %}
      <tr>
        <td>{{ t.tx_date }}</td>
        <td>{{ t.source }}</td>
        <td>{{ t.type }}</td>
        <td>{{ t.category }}</td>
        <td>${{ '%.2f'|format(t.amount) }}</td>
        <td>
          {% if t.receipt_path %}
            <a href="/ui/receipt/tx/{{ t.id }}">View</a>
          {% else %}
            â€”
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </table>
  </div>

  <div class="card">
    <h3 style="margin:0 0 8px;">Recent Fuel</h3>
    <table>
      <tr>
        <th>Date</th><th>Odometer</th><th>Cost</th><th>Receipt</th>
      </tr>
      {% for f in fuel %}
      <tr>
        <td>{{ f.fill_date }}</td>
        <td>{{ f.odometer_km }} km</td>
        <td>${{ '%.2f'|format(f.total_cost) }}</td>
        <td>
          {% if f.receipt_path %}
            <a href="/ui/receipt/fuel/{{ f.id }}">View</a>
          {% else %}
            â€”
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </table>
  </div>

</body>
</html>
